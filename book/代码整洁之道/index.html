



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.0">
    
    
      
        <title>代码整洁之道 - hope's blog</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.982221ab.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#_1" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="hope's blog" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              hope's blog
            </span>
            <span class="md-header-nav__topic">
              代码整洁之道
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="hope's blog" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    hope's blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="首页" class="md-nav__link">
      首页
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      常见配置
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        常见配置
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cfg/bwgconfig/" title="搬瓦工配置" class="md-nav__link">
      搬瓦工配置
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cfg/Markdown基本语法/" title="Markdown语法" class="md-nav__link">
      Markdown语法
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      书籍
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        书籍
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        代码整洁之道
      </label>
    
    <a href="./" title="代码整洁之道" class="md-nav__link md-nav__link--active">
      代码整洁之道
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="第一章 整洁代码" class="md-nav__link">
    第一章 整洁代码
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="第二章 有意义的命名" class="md-nav__link">
    第二章 有意义的命名
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" title="第三章 函数" class="md-nav__link">
    第三章 函数
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" title="短小" class="md-nav__link">
    短小
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" title="只做一件事" class="md-nav__link">
    只做一件事
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#switch" title="Switch语句" class="md-nav__link">
    Switch语句
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" title="函数参数" class="md-nav__link">
    函数参数
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#boolean" title="标识参数（Boolean）" class="md-nav__link">
    标识参数（Boolean）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" title="参数对象" class="md-nav__link">
    参数对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" title="无副作用" class="md-nav__link">
    无副作用
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" title="分隔指令和询问" class="md-nav__link">
    分隔指令和询问
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" title="使用异常替代返回错误码" class="md-nav__link">
    使用异常替代返回错误码
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trycatch" title="抽离try/catch代码块" class="md-nav__link">
    抽离try/catch代码块
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" title="错误处理就是一件事" class="md-nav__link">
    错误处理就是一件事
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" title="别重复自己" class="md-nav__link">
    别重复自己
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" title="第四章 注释" class="md-nav__link">
    第四章 注释
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" title="第五章 格式" class="md-nav__link">
    第五章 格式
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_15" title="第六章 对象和数据结构" class="md-nav__link">
    第六章 对象和数据结构
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_16" title="数据抽象" class="md-nav__link">
    数据抽象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" title="数据 对象反对称性" class="md-nav__link">
    数据 对象反对称性
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" title="得墨忒耳律" class="md-nav__link">
    得墨忒耳律
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" title="数据传送对象" class="md-nav__link">
    数据传送对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" title="小结" class="md-nav__link">
    小结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../代码相关书籍/" title="代码相关书籍" class="md-nav__link">
      代码相关书籍
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="第一章 整洁代码" class="md-nav__link">
    第一章 整洁代码
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="第二章 有意义的命名" class="md-nav__link">
    第二章 有意义的命名
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" title="第三章 函数" class="md-nav__link">
    第三章 函数
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" title="短小" class="md-nav__link">
    短小
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" title="只做一件事" class="md-nav__link">
    只做一件事
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#switch" title="Switch语句" class="md-nav__link">
    Switch语句
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" title="函数参数" class="md-nav__link">
    函数参数
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#boolean" title="标识参数（Boolean）" class="md-nav__link">
    标识参数（Boolean）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" title="参数对象" class="md-nav__link">
    参数对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" title="无副作用" class="md-nav__link">
    无副作用
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" title="分隔指令和询问" class="md-nav__link">
    分隔指令和询问
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" title="使用异常替代返回错误码" class="md-nav__link">
    使用异常替代返回错误码
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trycatch" title="抽离try/catch代码块" class="md-nav__link">
    抽离try/catch代码块
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" title="错误处理就是一件事" class="md-nav__link">
    错误处理就是一件事
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" title="别重复自己" class="md-nav__link">
    别重复自己
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" title="第四章 注释" class="md-nav__link">
    第四章 注释
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" title="第五章 格式" class="md-nav__link">
    第五章 格式
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_15" title="第六章 对象和数据结构" class="md-nav__link">
    第六章 对象和数据结构
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_16" title="数据抽象" class="md-nav__link">
    数据抽象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" title="数据 对象反对称性" class="md-nav__link">
    数据 对象反对称性
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" title="得墨忒耳律" class="md-nav__link">
    得墨忒耳律
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" title="数据传送对象" class="md-nav__link">
    数据传送对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" title="小结" class="md-nav__link">
    小结
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>代码整洁之道</h1>
                
                <h2 id="_1">第一章 整洁代码</h2>
<p><strong><em>later equals never</em></strong>：稍后等于永不</p>
<p><strong><em>整洁的代码只做好一件事情</em></strong></p>
<p>​   <em>每个函数，每个类，每个模块都全神贯注于一事情， 整洁的代码应该可由作者之外的开发者阅读和增补，应该包含有单元测试和验收测试。只提供一种而非多种做一件事的途径，只有尽量少的依赖关系，明确的定义和尽量少的API</em></p>
<p><strong>童子军军规</strong>：</p>
<p>​   <em>让营地比你来时更干净；如果每次签入的时候，代码都比签出时干净，那么代码就不会腐坏</em></p>
<h2 id="_2">第二章 有意义的命名</h2>
<p><strong>名副其实：</strong></p>
<p>​   如果名称需要注释来补充，那就不算名副其实了</p>
<p><strong>做有意义的区分</strong></p>
<p>​   废话是另一种没意义的区分。假如有一个Product类，如果还有一个ProductData/ProductInfo类，那他们的名称虽然不同，意思却相同，Info/Data就像a一样，是意义含混的废话</p>
<h2 id="_3">第三章 函数</h2>
<h3 id="_4">短小</h3>
<p>函数的第一规则是要短小，第二规则还是要短小</p>
<p>每个函数只做一件事情，做好一件事</p>
<p>if,else,while语句等，其中的代码块应该只有一行，该行大抵应该是一个函数调用语句</p>
<h3 id="_5">只做一件事</h3>
<p><em>如果函数只是做了该函数名下同一抽象层上的步骤，则函数还是只做了一件事，因此要确保函数只做一件事情的话，函数中的语句都要在同一个抽象层级上面</em></p>
<h3 id="switch">Switch语句</h3>
<pre><code class="java">public Money calculatePay(Employee e) throws InvalidEmployeeType{
  switch(e.type){
      case COMMISSIONED:
                    return calculateCommissionedPay(e);
            case HOURLY:
                    return calculateHourlyPay(e);
            case SALARIED:
                    return calculateSalariedPay(e);
            default:
                    throw new InvalidEmployeeType(e.type);
  }
}
</code></pre>

<p>此函数存在的问题是：</p>
<ol>
<li>
<p>首先，它太长，当出现新的雇员类型时，会更长</p>
</li>
<li>
<p>其次，做了明显不止一件事情</p>
</li>
<li>
<p>违反了单一权责原则（SRP），因为有好几个修改它的理由</p>
</li>
<li>违反了开放闭合原则（OCP），每当添加一个新类型，就必须修改</li>
<li>最麻烦的是，可能存在多个地方，会有相似的switch的type的判断，如方法isPayday()</li>
</ol>
<p>该问题解决方案为：</p>
<p>​   将switch<em>语句埋在抽象工厂底下，不让任何人看到，该工厂使用switch语句为Employee的派生类创建适合的实体，其他的函数藉由Employee接口多态的接受派遣</em></p>
<p>​   对于switch语句，如果只是出现一次，用于创建多态对象，而且隐藏在某个继承关系中，在系统其他的部分看不到，就还可以忍受。</p>
<p>整理后代码如下：</p>
<pre><code class="java">public abstract class Employee{
  public abstract boolean isPayday();
  public abstract Money calculatePay();
}
------------
public interface EmployeeFactory{
  public Employee makeEmployee(EmployeeRecord r) throws InvalidEmployeeType;
}
------------
public class EmployeeFactoryImpl implements EmployeeFactory{
  public Employee makeEmployee(EmployeeRecord r) throws InvalidEmployeeType{
    switch(r.type){
        case COMMISSIONED:
                    return calculateCommissionedPay(r);
                case HOURLY:
                    return calculateHourlyPay(r);
                case SALARIED:
                    return calculateSalariedPay(r);
                default:
                    throw new InvalidEmployeeType(r.type); 
    }
  }
}
</code></pre>

<h3 id="_6">函数参数</h3>
<p><strong><em>最理想的参数数量是0，其次是1，再次是2，应尽量避免3，有足够特殊的理由才能使用3个以上的参数，所以无论如何也不要这么做</em></strong></p>
<p>从单元测试的角度看，参数叫人为难，因为参数越多，需要测试的参数组合就越多</p>
<p>输出参数比输入参数还要让人难以理解，读函数时，我们惯于认为信息通过参数输入函数，通过返回值从函数中输出。我们不太期望信息通过参数输出。应避免使用输出参数。如果函数必须要修改某种状态，就修改所属对象的状态吧。（<strong>这里的意思就是说通过函数修改了其参数的内容</strong>）</p>
<h4 id="boolean">标识参数（Boolean）</h4>
<p>标识参数丑陋不堪。向函数传入布尔值简直就是骇人听闻的做法。这样做，方法签名立刻变得复杂起来，大声宣布本函数不止做一件事。如果标识为true将会这样做，标识为false则会那样做！</p>
<h4 id="_7">参数对象</h4>
<p>如果函数看来需要三个或者三个以上的参数，就说明其中一些参数应该封装为class了。</p>
<h4 id="_8">无副作用</h4>
<p>副作用是一种谎言。函数承诺只做一件事，但还是会做其他被藏起来的事。有时，它会对自己类中的变量做出未能预期的改动。有时，它会把变量搞成向函数传递的参数或是系统全局变量。无论哪种情况，都是具有破坏性的，会导致古怪的时序性耦合及顺序依赖。</p>
<p>如下函数：该函数使用标准算法来匹配 userName和password。如果匹配成功，返回 true，如果失败则返回 false。但它会有副作用</p>
<pre><code class="java">public class UserValidator {
        private Cryptographer cryptographer;
        public boolean checkPassword(String userName, String password) {
                User user = UserGateway.findByName(userName);
                if (user != User.NULL) {
                        String codedPhrase = user.getPhraseEncodedByPassword();
                        String phrase = cryptographer.decrypt(codedPhrase, password);
                        if (&quot;Valid Password&quot;.equals(phrase)) {
                                Session.initialize();
                                return true;
                        }
                }
                return false;
        }
}
</code></pre>

<p>这里副作用就在于对Session.initialize( )的调用。checkPassword函数，顾名思义，就是用来检查密码的。该名称并未暗示它会初始化该次会话。所以，当某个误信了函数名的调用者想要检查用户有效性时，就得<em><font color="red">冒抹除现有会话数据的风险</font></em></p>
<h3 id="_9">分隔指令和询问</h3>
<p>函数要么做什么事，要么回答什么事，二者不可兼得，就像上面的那样。</p>
<pre><code class="java">public boolean set(String attribute, String value);
</code></pre>

<p>“该函数设置某个指定属性，如果成功就返回true，如果不存在那个属性则返回false。这样就导致了以下语句：</p>
<pre><code class="java">if (set(&quot;username&quot;, &quot;unclebob&quot;))...
</code></pre>

<p>从读者的角度考虑一下吧。这是什么意思呢？它是在问username属性值是否之前已设置为unclebob吗？或者它是在问username属性值是否成功设置为unclebob呢？</p>
<p>真正的解决方案是把指令与询问分隔开来，防止混淆的发生：</p>
<pre><code class="java">if (attributeExists(&quot;username&quot;)) {
        setAttribute(&quot;username&quot;, &quot;unclebob&quot;);
}
</code></pre>

<h3 id="_10">使用异常替代返回错误码</h3>
<pre><code class="java">if (deletePage(page) == E_OK) {
        if (registry.deleteReference(page.name) == E_OK) {
            if (configKeys.deleteKey(page.name.makeKey()) == E_OK){
                    logger.log(&quot;page deleted&quot;);
            } else {
                logger.log(&quot;configKey not deleted&quot;);
            }
        } else {
            logger.log(&quot;deleteReference from registry failed&quot;);
        }
} else {
    logger.log(&quot;delete failed&quot;);
    return E_ERROR;
}
</code></pre>

<p>错误码会导致更深层次的嵌套的结构。当返回错误码的时候，就是在要求调用者立刻处理错误。</p>
<p>如果使用异常替代返回错误码，错误处理代码就能从主路径代码中分离出来，得到简化：</p>
<pre><code class="java">try{
    deletePage(page);
    registry.deleteReference(page.name);
    configKeys.deleteKey(page.name.makeKey);
}catch(Exception e){
    logger.log(e.getMessage());
}
</code></pre>

<h4 id="trycatch">抽离try/catch代码块</h4>
<p>try/catch代码块丑陋不堪，她们扰乱了代码结构，把错误处理与正常流程混为一谈。因此最好把try和catch代码块的主体部分抽离出来，另外形成函数</p>
<pre><code class="java">try{
  deletePageAndAllReferences(page);
}catch(Exception e){
  logError(e);
}
</code></pre>

<h4 id="_11">错误处理就是一件事</h4>
<p>函数只做一件事情，错误处理就是一件事。<font color="red"><strong><em>如果try在某个函数中存在，它就该是这个函数的第一个单词，而且在catch/finally代码块后面也不该有其他的内容</em></strong></font></p>
<h4 id="_12">别重复自己</h4>
<h2 id="_13">第四章 注释</h2>
<p><strong><em>别给糟糕的代码加注释-重新写吧</em></strong></p>
<p>每当要写注释的时候，看看能不能使用代码来表达意思</p>
<p>注释不能美化糟糕的代码，用代码来阐述注释的意思</p>
<p>能使用函数或者变量来表示意思时就别用注释</p>
<p>注释掉的代码：导致其他人不敢删除代码，我们删除掉即可，通过git他们丢不了</p>
<h2 id="_14">第五章 格式</h2>
<h2 id="_15">第六章 对象和数据结构</h2>
<p><strong><em>变量设置成私有的理由：我们不想别人依赖这些变量，不要直接给变量设置赋值器和取值器，如同它们根本就是公共变量一样</em></strong></p>
<h3 id="_16">数据抽象</h3>
<p>隐藏实现并非只是在变量之间放上一个函数层那么简单。隐藏关乎抽象，类并不简单地用取值器和赋值器将其变量推向外间，而是曝露抽象接口，以便用户无需了解数据的实现就能操作数据本体。</p>
<p>如下：你能确定前者里面都是些变量存取器，而却无法得知后者中的数据形态。</p>
<pre><code class="java">public interface Vehicle{
    double getFuelTankCapacityInGallons();
    double getGallonsOfGasoline();
}
</code></pre>

<pre><code class="java">public interface Vehicle {
    double getPercentFuelRemaining();
}
</code></pre>

<p>要以最好的方式呈现某个对象包含的数据，<font color="red">需要做严肃的思考，傻乐着加 取/赋值器，是最坏的选择</font></p>
<h3 id="_17">数据 对象反对称性</h3>
<p>对象把数据隐藏于抽象之后，曝露操作数据的函数。数据结构曝露其数据，没有提供有意义的函数</p>
<p><strong><em>过程式代码(使用数据结构的代码)便于在不改动既有数据结构的前提下添加新函数；面向对象代码；便于在不改动既有函数的前提下添加新类</em></strong></p>
<p>或者说：过程式代码难以添加新数据结构，因为必须修改所有函数。面向对象代码难以添加新函数，因为必须修改所有类。</p>
<p>在任何一个复杂系统中，都会有需要添加新数据类型而不是新函数的时候。这时，对象和面向对象就比较适合。另一方面，也会有想要添加新函数而不是数据类型的时候。在这种情况下，过程式代码和数据结构更合适。</p>
<h3 id="_18">得墨忒耳律</h3>
<p><strong><em>模块不应当了解它所操作的对象的内部的情形</em></strong>， 这意味着对象不应当通过存取器暴露其内部结构</p>
<p>类C的方法f函数只应该调用<strong>以下对象</strong>的方法</p>
<ul>
<li>
<p>C</p>
</li>
<li>
<p>由f创建的对象</p>
</li>
<li>
<p>作为参数传递给f的对象</p>
</li>
<li>
<p>由C的实体变量持有的对象</p>
</li>
</ul>
<p>方法不应该调用任何函数返回的对象的方法。换言之，只跟朋友交谈，不与陌生人交谈</p>
<p><strong>火车头失事</strong></p>
<pre><code class="java">final String outputDir = ctxt.getOptions().getScratchDir().getAbsolutePath();
</code></pre>

<p>违反得墨忒耳律，这类代码常被称作火车失事，因为它看起来就像是一列火车。这类连串的调用通常被认为是肮脏的风格，应该避免</p>
<p><em>如果ctxt、Options和ScratchDir只是数据结构，没有任何行为，则它们自然会曝露其内部结构，<strong>得墨忒耳律也就不适用了</strong></em></p>
<p><strong>隐藏结构</strong></p>
<p>上面的火车失事的代码，可以查看下最后取得outputDir是需要干嘛的，可以考虑取的outputDir后操作的代码放在ctxt对象中，这样就可以避免了，例如</p>
<pre><code class="java">BufferedOutputStream bos = ctxt.createScratchFileStream(classFileName);
</code></pre>

<h3 id="_19">数据传送对象</h3>
<p>最为精练的数据结构，是一个只有公共变量、没有函数的类。这种数据结构有时被称为数据传送对象，或DTO（Data Transfer Objects）。DTO是非常有用的结构。</p>
<p>更常见的是如下代码所示的“豆”（bean）结构。豆结构拥有由赋值器和取值器操作的私有变量。对豆结构的半封装会让某些OO纯化论者感觉舒服些，不过通常没有其他好处。</p>
<pre><code class="java">public class Address {
  private String street;

  public Address(String street) {
    this.street = street;
    }
  public String getStreet() {
    return street;
    }
}
</code></pre>

<h3 id="_20">小结</h3>
<p>对象曝露行为，隐藏数据。便于添加新对象类型而无需修改既有行为，同时也难以在既有对象中添加新行为。数据结构曝露数据，没有明显的行为。便于向既有数据结构添加新行为，同时也难以向既有函数添加新数据结构。</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../cfg/Markdown基本语法/" title="Markdown语法" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Markdown语法
              </span>
            </div>
          </a>
        
        
          <a href="../代码相关书籍/" title="代码相关书籍" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                代码相关书籍
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.2ba8dec4.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>